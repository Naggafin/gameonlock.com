{% extends 'peredion/dashboard/base.html' %}
{% load static i18n django_tables2 humanize %}
{% block content %}
    <div id="dashboard-content"
         x-data="dashboard({ totalBets: {{ total_bets|default:0 }}, totalPendingBets: {{ total_pending_bets|default:0 }}, totalWins: {{ total_wins|default:0 }}, totalLosses: {{ total_losses|default:0 }}, totalDeposit: {{ total_deposit|floatformat:2 }}, totalPayout: {{ total_payout|floatformat:2 }}, totalPendingStakes: {{ total_pending_stakes|floatformat:2 }} })">
        <div class="dashboard-statics">
            <div class="container">
                <div class="row g-lg-4 g-2">
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="" alt="" nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total bets' %}</span>
                                <span class="descr" x-text="totalBets"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="" alt="" nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total pending bets' %}</span>
                                <span class="descr" x-text="totalPendingBets"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="" alt="" nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total wins' %}</span>
                                <span class="descr" x-text="totalWins"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="" alt="" nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total losses' %}</span>
                                <span class="descr" x-text="totalLosses"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="{% static 'peredion/images/db-statics/image-2.png' %}"
                                     alt=""
                                     nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total profit' %}</span>
                                <span class="descr" x-text="`$${totalProfit}`"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="{% static 'peredion/images/db-statics/image-4.png' %}"
                                     alt=""
                                     nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total payout' %}</span>
                                <span class="descr" x-text="`$${formattedTotalPayout}`"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="{% static 'peredion/images/db-statics/image-3.png' %}"
                                     alt=""
                                     nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'total deposited' %}</span>
                                <span class="descr" x-text="`$${formattedTotalDeposit}`"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="{% static 'peredion/images/db-statics/image-5.png' %}"
                                     alt=""
                                     nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'pending stakes' %}</span>
                                <span class="descr" x-text="`$${formattedTotalPendingStakes}`"></span>
                            </div>
                        </div>
                    </div>
                    {% comment %}
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="{% static 'peredion/images/db-statics/image-6.png' %}" alt="" nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'referral earnings' %}</span>
                                <span class="descr" x-text="`$${totalReferral}`"></span>
                            </div>
                        </div>
                    </div>
                    {% endcomment %}
                    <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-6">
                        <div class="single-statics">
                            <div class="part-icon">
                                <img src="{% static 'peredion/images/db-statics/image-8.png' %}"
                                     alt=""
                                     nonce="{{ request.csp_nonce }}">
                            </div>
                            <div class="part-text">
                                <span class="text">{% trans 'bet winning %' %}</span>
                                <span class="descr" x-text="`${winPct}%`"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="db-elements">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="single-db-element">
                            <h4 class="title">
                                <span class="icon"><i class="fa-solid fa-chart-line"></i></span>
                                <span class="text">{% trans 'win & loss statistics' %}</span>
                            </h4>
                            <div id="chart" class="db-chart"></div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="single-db-element">
                            <h4 class="title">
                                <span class="icon"><i class="fa-solid fa-files"></i></span>
                                <span class="text">{% trans 'my recent bets' %}</span>
                            </h4>
                            <div class="sports-body">
                                <div class="table-responsive"
                                     id="bet-history-table"
                                     hx-get="{% url 'play_history' %}"
                                     hx-trigger="load"
                                     hx-swap="innerHTML">
                                    <p>{% trans 'Loading bet history...' %}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="single-db-element">
                            <h4 class="title">
                                <span class="icon"><i class="fa-solid fa-files"></i></span>
                                <span class="text">{% trans 'my recent transactions' %}</span>
                            </h4>
                            <div class="sports-body">
                                <div class="table-responsive"
                                     id="transaction-history-table"
                                     hx-get="{% url 'transaction_history' %}"
                                     hx-trigger="load"
                                     hx-swap="innerHTML">
                                    <p>{% trans 'Loading transaction history...' %}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block js %}
    <script src="{% static 'peredion/js/apexcharts.js' %}"
            nonce="{{ request.csp_nonce }}"></script>
    {{ chart_data|default:"{}"|json_script:"chart-data" }}
    {{ block.super }}
{% endblock %}
